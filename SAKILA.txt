#20 CHALLENGES ON QA USING SAKILA
USE SAKILA;
SHOW TABLES;

#1LIST ALL THE ACTORS
SELECT FIRST_NAME, LAST_NAME
FROM ACTOR;

#2FIND THE SURNAME OF THE ACTOR WITH THE FORENAME 'JOHN'
SELECT LAST_NAME, FIRST_NAME
FROM ACTOR
WHERE FIRST_NAME = 'JOHN';

#3 ALL ACTORS WITH SURNAME NEESON
SELECT LAST_NAME, FIRST_NAME
FROM ACTOR
WHERE LAST_NAME = 'NEESON';

#4WHAT IS THE DESCRIPTION OF THE MOVIE WITH AN ID OF 1000
#JOIN TO TABLES
SELECT F.FILM_ID, F.DESCRIPTION
FROM FILM F 
JOIN FILM_TEXT FT ON FT.DESCRIPTION = F.DESCRIPTION
WHERE F.FILM_ID = 1000 ;

#5FIND EVERY R-RATED MOVIE
DESCRIBE FILM;

SELECT TITLE, RATING
FROM FILM
WHERE RATING = 'R';

#6FIND EVERY NON-R RATED MOVIE
SELECT TITLE, RATING
FROM FILM 
WHERE RATING != 'R';

#7FIND THE 10 SHORTEST MOVIES
SELECT TITLE, LENGTH 
FROM FILM ORDER BY LENGTH ASC LIMIT 10;

#8FIND MOVIES WITH LONGEST RUN TIME WITHOUT USING LIMIT - NEED TO LOOK AT DEMO

#9FIND ALL MOVIES THAT HAVE DELETED SCENES
SELECT TITLE, SPECIAL_FEATURES 
FROM FILM
WHERE SPECIAL_FEATURES = 'DELETED SCENES';

# 10 using having reverse-alphabetically list the names that are not repeated
SELECT LAST_NAME
FROM ACTOR
GROUP BY LAST_NAME
HAVING COUNT(LAST_NAME) = 1
ORDER BY LAST_NAME DESC;


#11USING HAVING LIST THE LAST NAMES THAT APPEAR MORE THAN ONCE FROM HIGHEST TO LOWEST FREQUENCY
SELECT LAST_NAME
FROM ACTOR
GROUP BY LAST_NAME
HAVING COUNT(LAST_NAME) > 1
ORDER BY COUNT(LAST_NAME) ASC;

#12 WHICH ACTOR HAS APPEARED IN THE MOST FILMS
SELECT A.FIRST_NAME, A.LAST_NAME
FROM ACTOR A
JOIN FILM_ACTOR FA ON FA.ACTOR_ID = A.ACTOR_ID
GROUP BY A.ACTOR_ID
ORDER BY COUNT(A.ACTOR_ID) LIMIT 1;

#JOIN ACTOR AND FILM ACTOR

#GROUP BY ACTOR ID
#ORDER BY COUNT ACTOR ID
#LIMIT 1

#13WHEN IS ACADEMY DINOSAUR DUE?
SELECT TITLE, RELEASE_YEAR
FROM FILM
WHERE TITLE = 'ACADEMY DINOSAUR';
#2006

#14WHAT IS THE AVERAGE RUNTIME OF ALL FILMS
SELECT AVG(LENGTH) 
FROM FILM;

#15WHAT IS AVERAGE RUN TIME OF ALL FILMS IN EACH CATEGORY
SELECT AVG(FC.CATEGORY_ID)
FROM FILM_CATEGORY FC
JOIN FILM F ON F.FILM_ID = FC.FILM_ID;

#16LIST ALL MOVIES FEATURING A ROBOT
SELECT*
FROM FILM;

SELECT TITLE, DESCRIPTION
FROM FILM
WHERE DESCRIPTION LIKE '%ROBOT%';

SELECT*
FROM FILM;

#17HOW MANY MOVIES WERE RELEASED IN 2010
SELECT COUNT(TITLE), RELEASE_YEAR
FROM FILM
WHERE RELEASE_YEAR = '2010';

#18FIND THE TITLES OF ALL THE HORROR MOVIES
SELECT *
FROM CATEGORY;

CREATE VIEW TITLE 
AS 
SELECT TITLE, NAME
FROM CATEGORY
WHERE NAME = 'HORROR';


#19HOW MANY DISTINCT COUNTRIES ARE THERE
SELECT DISTINCT COUNT(COUNTRY)
FROM country;

#20LIST THE NAME OF EVERY LANGUAGE IN REVERSE-ALPHABETICAL ORDER
SELECT NAME
FROM LANGUAGE
ORDER BY NAME DESC;

#21LIST THE FULL NAMES OF EVERY ACTOR WHOSE SURNAME ENDS WITH 'SON' IN ALPHABETICAL ORDER BY THEIR FORENAME'
SELECT FIRST_NAME, LAST_NAME
FROM ACTOR
WHERE LAST_NAME LIKE '%SON%'
ORDER BY FIRST_NAME ASC;

#WHICH CATEGORY CONTAINS THE MOST MOST FILMS
































	


